clc; clear all; close all;

%% Set variables
Ts = 0.01;

% Without fluid (pumps off)
T0 = 0:Ts:5;                        % initialize
T1 = T0(end)+Ts:Ts:T0(end)+20;      % open  valves fully
T2 = T1(end)+Ts:Ts:T1(end)+20;      % close valves fully

T3 = T2(end)+Ts:Ts:T2(end)+5;       % open  valves partly
T4 = T3(end)+Ts:Ts:T3(end)+5;       % hold  valve positions
T5 = T4(end)+Ts:Ts:T4(end)+15;      % open  valves fully

T6 = T5(end)+Ts:Ts:T5(end)+5;       % close valves partly
T7 = T6(end)+Ts:Ts:T6(end)+5;       % hold  valve positions
T8 = T7(end)+Ts:Ts:T7(end)+15;      % close valves fully

% With fluid (pumps on)
T9  = T8(end)+Ts:Ts:T8(end)+300;    % wait for fluid to fill
T10 = T9(end)+Ts:Ts:T9(end)+20;     % open  valves fully
T11 = T10(end)+Ts:Ts:T10(end)+20;   % close valves fully

% Time
t1 = [T0 T1 T2 T3 T4 T5 T6 T7 T8];
t2 = [T9 T10 T11];
t  = [t1 t2];

% Valves
Valve_open = [zeros(1,length(T0))...
              ones(1,length(T1))...
              zeros(1,length(T2))...
              ones(1,length(T3))...
              zeros(1,length(T4))...
              ones(1,length(T5))...
              zeros(1,length(T6))...
              zeros(1,length(T7))...
              zeros(1,length(T8))...
              zeros(1,length(T9))...
              ones(1,length(T10))...
              zeros(1,length(T11))];

Valve_close = [ones(1,length(T0))...
               zeros(1,length(T1))...
               ones(1,length(T2))...
               zeros(1,length(T3))...
               zeros(1,length(T4))...
               zeros(1,length(T5))...
               ones(1,length(T6))...
               zeros(1,length(T7))...
               ones(1,length(T8))...
               ones(1,length(T9))...
               zeros(1,length(T10))...
               ones(1,length(T11))];
               
ValveLD_close = timeseries(Valve_close,t);
ValveLM_close = timeseries(Valve_close,t);
ValveMD_close = timeseries(Valve_close,t);
ValveMR_close = timeseries(Valve_close,t);
ValveRD_close = timeseries(Valve_close,t);

ValveLD_open = timeseries(Valve_open,t);
ValveLM_open = timeseries(Valve_open,t);
ValveMD_open = timeseries(Valve_open,t);
ValveMR_open = timeseries(Valve_open,t);
ValveRD_open = timeseries(Valve_open,t);

% Pumps
SetPumps = [zeros(1,length(t1))...
            ones(1,length(t2))*0.1];
            
SetPumpL = timeseries(SetPumps,t);
SetPumpR = timeseries(SetPumps,t);

%% Check data
figure(1)
plot(t,Valve_open,t,Valve_close)
legend('open','close')
xlabel('t'); ylabel('valve booleans')

%% Save data to .mat file
save('RL_TTS3_Controller_Blank.mat',...
     'SetPumpL','SetPumpR','Ts',...
     'ValveLD_close','ValveLM_close','ValveMD_close',...
     'ValveMR_close','ValveRD_close',...
     'ValveLD_open','ValveLM_open','ValveMD_open',...
     'ValveMR_open','ValveRD_open');
 